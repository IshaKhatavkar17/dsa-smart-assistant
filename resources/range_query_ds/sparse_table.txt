KEY: SPARSE_TABLE
ALIASES: RMQ Sparse Table, Range Minimum Query, Idempotent, Precomputation
CATEGORY: Range Query Data Structure
DIFFICULTY: Hard

WHEN_TO_USE:
- "Range minimum/maximum queries on static array"
- "No updates allowed"
- "Preprocessing acceptable"
- "Idempotent operation required" (min/max/gcd, not sum)

INTUITION:
Build 2D table: table[i][j] = min of elements from index i to i+2^j-1.
Each row doubles the range covered.
For range query [l, r]: find largest power of 2 fitting in range,
use two overlapping precomputed ranges to cover entire span.
Idempotent means overlapping is safe.

JAVA_TEMPLATE:
```java
class SparseTable {
    private int[][] table;
    private int[] logTable;
    
    public SparseTable(int[] arr) {
        int n = arr.length;
        logTable = new int[n + 1];
        table = new int[n][20]; // 20 is log2(10^6)
        
        // Precompute logarithms
        logTable[1] = 0;
        for (int i = 2; i <= n; i++) {
            logTable[i] = logTable[i / 2] + 1;
        }
        
        // Build sparse table
        for (int i = 0; i < n; i++) {
            table[i][0] = arr[i];
        }
        
        for (int j = 1; j < 20; j++) {
            for (int i = 0; i + (1 << j) <= n; i++) {
                table[i][j] = Math.min(table[i][j - 1], 
                                       table[i + (1 << (j - 1))][j - 1]);
            }
        }
    }
    
    public int query(int l, int r) {
        int len = r - l + 1;
        int j = logTable[len];
        
        return Math.min(table[l][j], 
                        table[r - (1 << j) + 1][j]);
    }
}
```

TIME_COMPLEXITY: O(n log n) preprocessing, O(1) per query
SPACE_COMPLEXITY: O(n log n)

COMMON_MISTAKES:
- Using sum instead of idempotent operation
- Wrong logarithm precomputation
- Off-by-one in sparse table construction
- Query logic error (wrong overlapping ranges)
- Using with mutable arrays (should be static)
